<!DOCTYPE html>
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> 
<html class="no-js" lang="en"> <!--<![endif]-->

<head>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width" />

	<title>Friend Voyage | Traveling just got a lot more social...</title>

	<link rel="stylesheet" href="css/normalize.css" />
	<link rel="stylesheet" href="css/foundation.css" />
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
  <link rel="stylesheet" href="css/jquery.share.css" />


  <style type="text/css">
  #map_canvas{
    height:550px;
    width:100%;
  }
  #selections{
    position:fixed;
    top:55px;
    left:75px;
    width:300px;
  }
  label{
    padding:5px;
  }
  #submitselectionbutton{
    padding:5px;
  }
  #header,
  #footer{
    height:50px;
  }
  p.title{
    height:50px;
    padding:10px;
  }
  .pictureselect{
    opacity: .25;
  }
  .pictureselect p{
    font:12px;
    float:left;
  }
  .pictureselect:hover{
    opacity: .5;
  }
  .pictures{
    width:100%;
    -moz-column-count:4; /* Firefox */
    -webkit-column-count:4; /* Safari and Chrome */
    column-count:4;
    text-align: center;
    font-size: 10px
  }
  #registerview,
  #resetview,
  #resetviewinfofilled,
  #registerwith{
    visibility: hidden;
    position:absolute;
  }
  #signinview,
  #signinwith{
    visibility: visible;
    position:absolute;
  }
  #signinmodal{
    height:525px;
  }
  .socialdiv{
    float:left;
    margin-left:300px;
    margin-right:20px;
    padding:20px;
  }
  .viewdiv{
    float:left;
  }
  </style>

</head>

<body onload="initMap()">

  <!-- header included from header-->
  <div id="header">
    <img src= "img/friendvoyage.png" style="
    margin-top: 5px;"></img>
  </div>

  <!-- body includes map-->
  <div id="body">
    <div id="map_canvas"></div>
  </div>

  <!-- selections, which enables user input-->
  <div id="selections" class="section-container" data-section="accordion">

    <section class="section active">
      <p class="title" data-section-title><a href="#">Where Are You Going?</a></p>
      <div class="content" data-section-content>
        <div class="row collapse">
          <div class="small-10 columns">
            <input type="text" id="address" placeholder="Add Location or Drop Pin">
          </div>
          <div class="small-2 columns">
            <a href="#" class="button prefix" id = "valuesubmit" onclick="addtolist(address.value)">Add</a>
          </div>
        </div>
        <div class="placeselected" id="addingcities">
          <ul class="side-nav">
            <li>Destinations Selected:</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="section">
      <p class="title" data-section-title><a href="#">When Are You Going?</a></p>
      <div class="content" data-section-content>
        <p>From: <input type="text" id="fromdatepicker" /></p>
        <p>To: <input type="text" id="todatepicker" /></p>
      </div>
    </section>

    <section class="section">
      <p class="title" data-section-title><a href="#">What Would You Like To Do?</a></p>
      <div id="activityselection" class="content" data-section-content>

        <form class="pictures">
          <img class="pictureselect" src="img/arts.png" title="arts" id="arts" onclick="selectimage('arts')"/><p>Arts</p>
          <img class="pictureselect" src="img/coffee.png" title="coffee" id="coffee" onclick="selectimage('coffee')"/><p>Coffee</p>
          <img class="pictureselect" src="img/drinks.png" title="drinks" id="drinks" onclick="selectimage('drinks')"/><p>Drinks</p>
          <img class="pictureselect" src="img/family.png" title="family" id="family" onclick="selectimage('family')"/><p>Family</p>
          <img class="pictureselect" src="img/food.png" title="food" id="food" onclick="selectimage('food')"/><p>Food</p>
          <img class="pictureselect" src="img/nightlife.png" title="nightlife" id="nightlife" onclick="selectimage('nightlife')"/><p>Nightlife</p>
          <img class="pictureselect" src="img/shopping.png" title="shopping" id="shopping" onclick="selectimage('shopping')"/><p>Shopping</p>
          <img class="pictureselect" src="img/sights.png" title="sights" id="sights" onclick="selectimage('sights')"/><p>Sights</p>
        </form>
      </div>
    </section>

    <section class="section">
      <p class="title" data-section-title><a href="#">Give Your Trip an Epic Name</a></p>
      <div class="content" data-section-content>
        <form class="custom">
          <input type="text" id="tripname" placeholder="Name Your Trip">
        </form>
        <a href="#" class="button" id="submitselectionbutton" onclick="openModal('#signinmodal')">Submit Trip</a>
      </div>
    </section>
  </div>

  <div id="footer">
  </div>

  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script src="js/vendor/custom.modernizr.js"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
  <script>
  var selectimage = function(obj){
    if(document.getElementById(obj).style.opacity < "1"){
      document.getElementById(obj).style.opacity = "1";
    }
    else
      document.getElementById(obj).style.opacity = ".25";
  }
  </script>
  <script src="js/jquery.share.js"></script>                     

  <script type="text/javascript">
    //initializes the datepicker
    $('#fromdatepicker').datepicker();
    $('#todatepicker').datepicker();						

    //initializes share
    $(document).ready(function () {
      $('#socialnetworks').share({
        networks: ['facebook','twitter','googleplus','linkedin','pinterest','tumblr','stumbleupon','email'],
        theme: 'square'
      });
    });
	//closes the modal by the button
	function closeModal(id){
		//$('a.close-reveal-modal').trigger('click');
		$(id).foundation('reveal', 'close');

	}

	function openModal(id){
		$(id).foundation('reveal', 'open');
	}

	//initializes map
	function initMap(){
		//initializing modal the opening window
		$('#myModal').foundation('reveal', 'open');
		$('#myModal').foundation('reveal', 'close');
        //initializing the map
        var map;
        var myOptions = {
        	zoom: 2,
        	center: latlng = new google.maps.LatLng(0, 0),
        	mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var marker = new google.maps.Marker({});

        //initialize auto complete
        var input = document.getElementById('address');
        var autocomplete = new google.maps.places.Autocomplete(input);
        //autocomplete.bindTo('bounds', map);
        var infowindow = new google.maps.InfoWindow();

        google.maps.event.addListener(autocomplete, 'place_changed', function() {
        	infowindow.close();
        	marker.setVisible(true);
        	input.className = '';
        	var place = autocomplete.getPlace();
        	if (!place.geometry) {
            // Inform the user that the place was not found and return.
            input.className = 'notfound';
            return;
          }

          // If the place has a geometry, then present it on a map.
          if (place.geometry.viewport) {
          	map.fitBounds(place.geometry.viewport);
          } else {
          	map.setCenter(place.geometry.location);
            map.setZoom(17);  // Why 17? Because it looks good.
          }
          marker.setPosition(place.geometry.location);
          marker.setVisible(true);

          var address = '';
          if (place.address_components) {
           address = [
           (place.address_components[0] && place.address_components[0].short_name || ''),
           (place.address_components[1] && place.address_components[1].short_name || ''),
           (place.address_components[2] && place.address_components[2].short_name || '')
           ].join(' ');
         }

         console.log(place)
         var e = {
           latLng: {
            lat: function () {
             return place.geometry.location.jb;
           },
           lng: function () {
             return place.geometry.location.kb;
           }
         }
       }
       addMarkerHandler(e);
       addtolist(place.formatted_address);
     });

google.maps.event.addDomListener(window, 'load', initMap);

        //instance of the map
        var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        //array to hold all the markers
        var markers = {};
        //create id for marker
        var markeridcreator=function(lat, lng){return lat + '_' + lng;};
        //create a lat lng getter
        var getlatlng = function(lat, lng){return new google.maps.LatLng(lat, lng);};
        //add marker
        var addMarker = google.maps.event.addListener(map, 'click', addMarkerHandler);
        //function that is called when addMarker is called
        var placename;

        var addMarkerHandler = function(e){
        	console.log(e);
        	var lat = e.latLng.lat();
        	var lng = e.latLng.lng();
        	var markerid = markeridcreator(lat, lng);
        	var marker = new google.maps.Marker({
        		position: getlatlng(lat, lng),
        		map: map,
        		id: 'marker_' + markerid,
        		//icon: 'img/marker.png'
        	});
        	markers[markerid] = marker;
        	markerevent(marker);
        	//reverse lookup
        	var geocoder = new google.maps.Geocoder();
        	var infowindow = new google.maps.InfoWindow();
        	var latlng = getlatlng(lat, lng);
        	geocoder.geocode({'latLng': latlng}, function(results) {
        		infowindow.setContent(results[1].formatted_address);
        		//infowindow.open(map, marker);	
                //placename = results[1].formatted_address;
              });
        }
        //marker event binder
        var markerevent = function(marker){
        	google.maps.event.addListener(marker, "rightclick", function(e){
        		var markerid = markeridcreator(e.latLng.lat(), e.latLng.lng());
        		var marker = markers[markerid];
        		deletemarker(marker, markerid);
        	});
        };
        //marker delete
        var deletemarker = function(marker, markerid){
        	marker.setMap(null);
        	delete markers[markerid];
            //removefromlist(placename);
          };	
        //remove value from list
        var removefromlist = function(val){
          $("#addingcities ul").remove('<li><a href="#">'+val+'</a></li>');
            //$("#addingcities ul").update();
          }
        }
        </script>

        <script>
    //add the inputted item in the list
    var addtolist = function(val){
    	$("#addingcities ul").append('<li><a href="#">'+val+'</a></li>');
    	$("#valuesubmit").val("");
    }
    </script>

    <script>
    	//must add in order for foundation to work
    	document.write('<script src=' +
    		('__proto__' in {} ? 'js/vendor/zepto' : 'js/vendor/jquery') +
    		'.js><\/script>')
    	</script>
    	<script src="js/foundation/foundation.js"></script>
    	<script src="js/foundation/foundation.alerts.js"></script>
    	<script src="js/foundation/foundation.clearing.js"></script>
    	<script src="js/foundation/foundation.cookie.js"></script>
    	<script src="js/foundation/foundation.dropdown.js"></script>
    	<script src="js/foundation/foundation.forms.js"></script>
    	<script src="js/foundation/foundation.joyride.js"></script>
    	<script src="js/foundation/foundation.magellan.js"></script>
    	<script src="js/foundation/foundation.orbit.js"></script>
    	<script src="js/foundation/foundation.placeholder.js"></script>
    	<script src="js/foundation/foundation.reveal.js"></script>
    	<script src="js/foundation/foundation.section.js"></script>
    	<script src="js/foundation/foundation.tooltips.js"></script>
    	<script src="js/foundation/foundation.topbar.js"></script>
    	<script>
    	$(document).foundation();
    	</script>

    	<div id="myModal" class="reveal-modal">
    		<h2>Welcome to Friend Voyage!</h2>
    		<p class="lead">a socially driven travel planning platform which allows you to get the best recommendations from your friends</p>
    		<p>Ready to begin?</p>
    		<a href="#" class="large button" onclick="closeModal('#myModal')">Start Now</a>
    		<a class="close-reveal-modal">&#215;</a>
    	</div>

      <script>
      var inputmode = function(obj){
        if(obj == 'register'){
          document.getElementById('signinview').style.visibility = 'hidden';
          document.getElementById('registerview').style.visibility = 'visible';
          document.getElementById('resetview').style.visibility = 'hidden';
          document.getElementById('resetviewinfofilled').style.visibility = 'hidden';
          document.getElementById('registerwith').style.visibility = 'visible';
          document.getElementById('signinwith').style.visibility = 'hidden';
        }
        else if(obj == 'signin'){
          document.getElementById('signinview').style.visibility = 'visible';
          document.getElementById('registerview').style.visibility = 'hidden';
          document.getElementById('resetview').style.visibility = 'hidden';
          document.getElementById('resetviewinfofilled').style.visibility = 'hidden';
          document.getElementById('registerwith').style.visibility = 'hidden';
          document.getElementById('signinwith').style.visibility = 'visible';
        }
        else if(obj == 'reset'){
          document.getElementById('signinview').style.visibility = 'hidden';
          document.getElementById('registerview').style.visibility = 'hidden';
          document.getElementById('resetview').style.visibility = 'visible';
          document.getElementById('resetviewinfofilled').style.visibility = 'hidden';
          document.getElementById('registerwith').style.visibility = 'hidden';
          document.getElementById('signinwith').style.visibility = 'hidden';
        }
        else if(obj == 'resetfilled'){
          document.getElementById('signinview').style.visibility = 'hidden';
          document.getElementById('registerview').style.visibility = 'hidden';
          document.getElementById('resetview').style.visibility = 'hidden';
          document.getElementById('resetviewinfofilled').style.visibility = 'visible';
          document.getElementById('registerwith').style.visibility = 'hidden';
          document.getElementById('signinwith').style.visibility = 'hidden';
        }
      }
      </script>
      <div id="signinmodal" class="reveal-modal">

        <div class="viewdiv">

          <div id="signinview">
            <h2>Sign In</h2>
            <input type="text" placeholder="Enter your e-mail address here"/>
            <input type="password" placeholder="Enter your password here"/>
            <p>Don't have an account? <a href = "#" onclick = "inputmode('register')">Register Here</a></p>
            <p>Forgot your password? <a href = "#" onclick = "inputmode('reset')">Reset It Here</p>
            <a href="#" class="large button" onclick="openModal('#linkmodal')">Sign In</a>
          </div>

          <div id="registerview">
            <h2>Registration</h2>
            <input type="text" placeholder="Enter your e-mail address here"/>
            <input type="text" placeholder="Re-enter your e-mail address here"/>
            <input type="password" placeholder="Enter your password here"/>
            <input type="password" placeholder="Re-enter your password here"/>
            <p>Already have an account? <a href = "#" onclick = "inputmode('signin')">Sign In Here</a></p>
            <p>Forgot your password? <a href = "#" onclick = "inputmode('reset')">Reset It Here</p>
            <a href="#" class="large button" onclick="openModal('#linkmodal')">Register</a>
          </div>

          <div id="resetview">
            <h2>Password Recovery</h2>
            <input type="text" placeholder="Enter the e-mail you registered here"/>
            <p>Don't have an account? <a href = "#" onclick = "inputmode('register')">Register Here</a></p>
            <p>Already have an account? <a href = "#" onclick = "inputmode('signin')">Sign In Here</a></p>
            <a href="#" class="large button" onclick="inputmode('resetfilled')">Reset Account</a>
          </div>

          <div id="resetviewinfofilled">
            <h2>Thank You! Please check your email and click on the link to reset your password</h2>
            <p><a href = "#" onclick = "inputmode('signin')">Click here</a> to go back to the sign in screen</p>
          </div>

        </div>

        <div class="socialdiv">

          <div id="signinwith">
            <h4>... or signin using your social network credentials</h4>
          </div>

          <div id="registerwith">
            <h4>... or register using your social network credentials</h4>
          </div></br></br></br></br></br></br></br>

          <div id="socialnetworks"></div>

        </div>
        <a class="close-reveal-modal">&#215;</a>
      </div>   

      <div id="linkmodal" class="reveal-modal">
        <h2>Congratulations! Here is the link for your map. Share it with your friends!</h2>
        <input type="text" id="linktomap" value="file:///C:/Users/Rodrigo/SkyDrive/Code/FriendVoyage/recommendation.html" onclick="window.open('Recommendation.html', '_self')"/>
        <p>Share it on your favorite social networks too!</p>
        <div id="socialnetworks"></div></br>
        <a href="#" class="large button" onclick="window.open('Results.html', '_self')">Take Me Home</a>
        <a class="close-reveal-modal">&#215;</a>
      </div>  

    </body>
    </html>