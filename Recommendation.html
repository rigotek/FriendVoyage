<!DOCTYPE html>
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> 
<html class="no-js" lang="en"> <!--<![endif]-->

<head>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width" />

	<title>Friend Voyage | Traveling just got a lot more social...</title>

	<link rel="stylesheet" href="css/normalize.css" />
	<link rel="stylesheet" href="css/foundation.css" />
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
  <link rel="stylesheet" href="css/jquery.share.css" />

  <style type="text/css">
  #map_canvas{
    height:550px;
    width:100%;
  }
  #selections{
    position:fixed;
    top:55px;
    left:75px;
    width:300px;
  }
  label{
    cursor:pointer;
  }
  #submitselectionbutton{
    padding:5px;
  }
  #header,
  #footer{
    height:50px;
  }
  #footer{
    width:100%;
    background-color: #cccccc;
  }
  #blackline{
    width:100%;
    height:5px;
    background-color: black;
  }
  p.title{
    height:50px;
    padding:10px;
  }
  .pictureselect input,
  .gradeselect input{
    visibility: hidden;
  }
  .gradeselect{
    margin-bottom:-60px;
    margin-top:-20px;
    width: 75px;
  }
  #givegrade{
    margin-left: 27px;
    height:30px;
  }
  .pictureselect p{
    font:12px;
    float:left;
    text-align: center;
    width:100%;
    margin-bottom:-10px;
  }
  .gradeselect{
    float:left;
    padding:10px;
    width:80px;
  }
  #activities li{
    text-align: center;
  }
  #activities{
    margin-bottom: -15px;
  }
  .pictures{
    width:100%;
    -moz-column-count:4; /* Firefox */
    -webkit-column-count:4; /* Safari and Chrome */
    column-count:4;
    text-align: center;
    font-size: 10px;
    list-style: none;
  }
  .pictureselect:hover,
  .gradeselect:hover{
    opacity: .25;
  }
  #recommendationtext{
    height:100px;
    overflow: auto;
  }
  #registerview,
  #resetview,
  #resetviewinfofilled,
  #registerwith{
    visibility: hidden;
    position:absolute;
  }
  #signinview,
  #signinwith{
    visibility: visible;
    position:absolute;
  }
  #signinmodal{
    height:525px;
  }
  .socialdiv{
    float:left;
    margin-left:300px;
    margin-right:20px;
    padding:20px;
  }
  .viewdiv{
    float:left;
  }
  h3{
    font-size: 14px;
    padding:5px;
  }
  #filterselections{
    background-color: #CCCCCC;
  }
  #recheader{
    margin-top: -20px;
  }
  #finditheader{
    margin-top: -10px;
  }
  #decorationline{
    height:5px;
    width:100%;
    background-color:black;
    margin-top:45px;
    position:absolute;
  }
  </style>

</head>

<body onload="initMap()">

  <!-- header included from header-->
  <div id="header">
    <div id="decorationline"></div>
    <nav class="top-bar">
      <ul class="title-area">
        <li class="name">
          <img src= "img/friendvoyage.png" style="
          margin-top: 2px;"></img>        
        </li>
        <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
      </ul>
      <section class="top-bar-section">
        <ul class="right">
          <li class="divider"></li>
          <li><a href="#">About Us</a></li>
          <li class="divider"></li>
          <li class="active has-dropdown"><a href="#">Settings</a>
            <ul class="dropdown">
              <li><a href="#">Login/Logout</a></li>
              <li><a href="#">Preferences</a></li>
            </ul>
          </li>
        </ul>
      </section>
    </nav>
  </div>


  <!-- body includes map-->
  <div id="body">
    <div id="map_canvas"></div>
  </div>

  <div id="filterselections">

    <div id="selections" class="section-container" data-section="accordion">

      <section class="section active" id="step1">
        <p class="title" data-section-title>
          <a href="#">
            Select a category
          </a>
        </p>
        <div class="content" data-section-content>
          <div id="activities">
            <div class="pictures">
              <div class="pictureselect">
                <label for="adventure">
                  <img src="img/adventure.png" title="adventure"/>
                </label>
                <p>Adventure</p>
                <input class="pictureselect" name="adventure" type="radio" id="adventure" value="adventure">
              </div> 

              <div class="pictureselect">
                <label for="arts">
                  <img src="img/arts.png" title="arts"/>
                </label>
                <p>Arts</p>
                <input class="pictureselect" name="arts" type="radio" id="arts" value="arts">
              </div>

              <div class="pictureselect">
                <label for="coffee">
                  <img src="img/coffee.png" title="coffee"/>
                </label>
                <p>Coffee</p>
                <input name="coffee" type="radio" id="coffee" value="coffee">
              </div>

              <div class="pictureselect">
                <label for="drinks">
                  <img src="img/drinks.png" title="drinks"/>
                </label>
                <p>Drinks</p>
                <input name="drinks" type="radio" id="drinks" value"drinks">
              </div>

              <div class="pictureselect">
                <label for="food">
                  <img src="img/food.png" title="food"/>
                </label>
                <p>Food</p>
                <input name="food" type="radio" id="food" value="food">
              </div> 

              <div class="pictureselect">
                <label for="nightlife">
                  <img src="img/nightlife.png" title="nightlife"/>
                </label>
                <p>Nightlife</p>
                <input name="nightlife" type="radio" id="nightlife" value="nightlife">
              </div> 

              <div class="pictureselect">
                <label for="shopping">
                  <img src="img/shopping.png" title="shopping"/>
                </label>
                <p>Shopping</p>
                <input name="shopping" type="radio" id="shopping" value="shopping">
              </div> 

              <div class="pictureselect">
                <label for="sights">
                  <img src="img/sights.png" title="sights"/>
                </label>
                <p>Sights</p>
                <input name="sights" type="radio" id="sights" value="sights">
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="step2">
        <p class="title" data-section-title>
          <a href="#">Tell us the juicy details
          </a>
        </p>
        <div id="recommendations">
          <div class="content" data-section-content>
            <div class="row">
              <textarea id="recommendationtext" placeholder="Tell Your Friend Why You Recommend This Place"></textarea>
              <p>What overall grade would you give this place?</p>
              <div id="givegrade">
                <div class="gradeselect">
                  <label for="good">
                    <img src="img/good.png" title="good"/>
                  </label>
                  <input name="good" type="radio" id="good" value="good">
                </div> 

                <div class="gradeselect">
                  <label for="neutral">
                    <img src="img/neutral.png" title="neutral"/>
                  </label>
                  <input name="neutral" type="radio" id="neutral" value="neutral">
                </div> 

                <div class="gradeselect">
                  <label for="bad">
                    <img src="img/bad.png" title="bad"/>
                  </label>
                  <input name="bad" type="radio" id="bad" value="bad">
                </div>

              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="section" id="step3">
        <p class="title" data-section-title>
          <a href="#">Find it on the map</a>
        </p>
        <div class="content" data-section-content>
          <div class="row">
            <input class="small-10 columns" type="text" id="address" placeholder="Find location">
            <a href="#" class="button prefix small-2 columns" id = "valuesubmit" onclick="addtolist(address.value)">Add</a>
          </div>
        </div>
      </section>

      <section class="section" id="step4">
        <p class="title" data-section-title>
          <a href="#">Submit recommendations</a>
        </p>
        <div class="content" data-section-content>
          <div class="row">
            <a href='#' class="button small-5 columns" type="button" id="address" onclick="startoveraccordion()">Add More</a>
            <a href='#' class="button small-5 columns" type="button" id="address">I'm Done</a>
          </div>
        </div>
      </section>

    </div><!--selections-->
  </div><!--filter selections-->

  <ol class="joyride-list" data-joyride>
    <li data-id="step1" data-text="Next" data-options="tipLocation:left">
      <p>Select an icon that best represents what you're recommending</p>
    </li>
    <li data-id="step2" data-text="Next" data-options="tipLocation:left">
      <p>Why should your friend visit this place?</p>
    </li>
    <li data-id="step3" data-text="Next" data-options="tipLocation:left">
      <p>Find it using the textbox</p>
    </li>
    <li data-id="step4" data-text="Next" data-options="tipLocation:left">
      <p>Wanna keep going? Hit yes, if you're done, hit complete</p>
    </li>
  </ol>

  <div id="footer">
    <div id="blackline"></div>
  </div>

  <!-- all the scripts for foundation to work-->
  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script src="js/vendor/custom.modernizr.js"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
  <script src="js/jquery.share.js"></script>    

  <script type="text/javascript">			

    //initializes sharing on facebook
    $(document).ready(function(){
      $('#socialnetworks').share({
        networks: ['facebook','twitter','googleplus','linkedin','pinterest','tumblr','stumbleupon','email'],
        theme: 'square'
      });
    });

    //closes and opens the modal by the button
    function closeModal(id){
      $(id).foundation('reveal', 'close');
    }
    function openModal(id){
      $(id).foundation('reveal', 'open');
    }

    //initializes map
    function initMap(){
      //options to set the primary view for the map
      var myOptions = {
        zoom: 2, //how zoomed to start off
        center: latlng = new google.maps.LatLng(0, 0), //starts in the middle of the map
        mapTypeId: google.maps.MapTypeId.ROADMAP //starts in roadmap view
      };
      //pins to be dropped
      var marker = new google.maps.Marker({});

      //initialize auto complete for the address bar
      var input = document.getElementById('address');
      var autocomplete = new google.maps.places.Autocomplete(input);
      var infowindow = new google.maps.InfoWindow({}); //ADD HERE THE COMMENTS PEOPLE WILL MAKE ABOUT THE PLACE, AS WELL AS YELP'S API?

      //event listener that attemps to see whether someone is typing on the input field
      google.maps.event.addListener(autocomplete, 'place_changed', function() {
        infowindow.close();
        //marker.setVisible(true);
        input.className = '';
        var place = autocomplete.getPlace();
        if (!place.geometry) {
            // Inform the user that the place was not found and return.
            input.className = 'notfound';
            return;
          }
        // If the place has a geometry, then present it on a map.
        if (place.geometry.viewport) {
          map.fitBounds(place.geometry.viewport);
        } 
        else{
          map.setCenter(place.geometry.location);
          map.setZoom(12);  //Once place selected, it zooms to that location 
        }
        //drops the pin at the location inputted
        //marker.setPosition(place.geometry.location);
        //marker.setVisible(true);

        //part of google places api
        var address = '';
        if (place.address_components) {
          address = [
          (place.address_components[0] && place.address_components[0].short_name || ''),
          (place.address_components[1] && place.address_components[1].short_name || ''),
          (place.address_components[2] && place.address_components[2].short_name || '')
          ].join(' ');
        }
        //console.log(place) //good tool used to verify the location of a place inputted on the console

        //this finds the latitude and longitude of the place inputted and adds a marker          
        var e = {
          latLng: {
            lat: function (){
              return place.geometry.location.jb;
            },//latLng
            lng: function () {
              return place.geometry.location.kb;
            }//lng
          }//latLng
        }//e

        //function used to add the marker onto the map
        addMarkerHandler(e);
        addtolist(place.formatted_address);
      });//google maps auto complete

      //this is an icon selector for the drop pins
      $("div.pictureselect").click(function(){
        var checked=$(this).find('input:radio').attr('checked', true);
        //alert(checked.val());
        imageicon='img/'+checked.val()+'.png';
        $(this).parent('div.pictures').find('label').css('opacity', '.25');
        $(this).find('label').css('opacity', '1');
      });

      //this is an icon selector for the drop pins
      $("div.gradeselect").click(function(){
        //console.log($(this));
        var checked=$(this).find('input:radio').attr('checked', true);
        $(this).parent('div#givegrade').find('label').css('opacity', '.25');
        $(this).find('label').css('opacity', '1');
      });

      //this loads the map onto the screen
      google.maps.event.addDomListener(window, 'load', initMap); 
      
      //instance of the map
      var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
      
      //array to hold all the markers
      var markers = {};
      
      //create id for marker
      var markeridcreator=function(lat, lng){return lat + '_' + lng;};
      
      //create a lat lng getter
      var getlatlng = function(lat, lng){return new google.maps.LatLng(lat, lng);};

      //function that is called on google maps auto complete to add the address onto the screen
      var addMarkerHandler = function(e){
        console.log(e);
        var lat = e.latLng.lat();
        var lng = e.latLng.lng();
        var markerid = markeridcreator(lat, lng);
        var marker = new google.maps.Marker({
        	position: getlatlng(lat, lng), //gets lat and long
        	map: map, //puts the map with the variable
        	id: 'marker_' + markerid, //helps to identify which is which
        	icon: imageicon //grabs it from the checking function
        });

        //adds marker to the array
        markers[markerid] = marker;

        //adds marker to event trigger
        markerevent(marker);

        //allows for the info window to pop up
        var geocoder = new google.maps.Geocoder();
        var infowindow = new google.maps.InfoWindow();
        var latlng = getlatlng(lat, lng);
        geocoder.geocode({'latLng': latlng}, function(results) {
         infowindow.setContent(results[1].formatted_address);
       });
        //API which allows for the clicking to bind to the infowindow action
        google.maps.event.addListener(marker, 'click', function(){
          infowindow.open(map,marker);
        });
      }//addmarkerhandler

      //marker event binder - getting ready for removal
      var markerevent = function(marker){
        google.maps.event.addListener(marker, "rightclick", function(e){
        	var markerid = markeridcreator(e.latLng.lat(), e.latLng.lng());
        	var marker = markers[markerid];
        	deletemarker(marker, markerid);
        });
      };

      //marker delete
      var deletemarker = function(marker, markerid){
      	marker.setMap(null);
      	delete markers[markerid];
        //removefromlist(placename);
      };	

      //remove value from list
      var removefromlist = function(val){
        $("#addingcities ul").remove('<li><a href="#">'+val+'</a></li>');
          //$("#addingcities ul").update();
        }
      }

      //add the inputted item to the list
      //in this case, we will have to make sure to fill out the accordion with this
      var addtolist = function(val){
    	   //$("#addingcities ul").append('<li><a href="#">'+val+'</a></li>');
    	   $("#valuesubmit").val("");
       }
       </script>

       <script>
  //must add in order for foundation to work
  document.write('<script src=' +
   ('__proto__' in {} ? 'js/vendor/zepto' : 'js/vendor/jquery') +
   '.js><\/script>')
  </script>

  <script src="js/foundation/foundation.js"></script>
  <script src="js/foundation/foundation.alerts.js"></script>
  <script src="js/foundation/foundation.clearing.js"></script>
  <script src="js/foundation/foundation.cookie.js"></script>
  <script src="js/foundation/foundation.dropdown.js"></script>
  <script src="js/foundation/foundation.forms.js"></script>
  <script src="js/foundation/foundation.joyride.js"></script>
  <script src="js/foundation/foundation.magellan.js"></script>
  <script src="js/foundation/foundation.orbit.js"></script>
  <script src="js/foundation/foundation.placeholder.js"></script>
  <script src="js/foundation/foundation.reveal.js"></script>
  <script src="js/foundation/foundation.section.js"></script>
  <script src="js/foundation/foundation.tooltips.js"></script>
  <script src="js/foundation/foundation.topbar.js"></script>
  <script>
  $(document).foundation();
  </script>

  <!-- scripts to make the popup guide work-->
  <script type="text/javascript">
  $(document).foundation('joyride', 'start');
  </script>

  <!-- script to make the add more button work-->
  <script>
  var startoveraccordion=function(){
    $('.section').removeClass('active');
    $('#step1').addClass('active');
    //$(this).addClass('showhidenew');
  }
  </script>
  <div id="linkmodal" class="reveal-modal">
    <h2>Congratulations! Here is the link for your map. Share it with your friends!</h2>
    <input type="text" id="linktomap" value="file:///C:/Users/Rodrigo/SkyDrive/Code/FriendVoyage/recommendation.html" onclick="window.open('Recommendations.html', '_self')"/>
    <p>Share it on your favorite social networks too!</p>
    <div id="socialnetworks"></div></br>
    <a href="#" class="large button" onclick="window.open('Results.html', '_self')">Take Me Home</a>
    <a class="close-reveal-modal">&#215;</a>
  </div>  

</body>
</html>